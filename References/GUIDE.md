# CHOCCY优化器使用指南

## 目录
1. [简介](#简介)
2. [安装](#安装)
3. [算法介绍](#算法介绍)
4. [快速开始](#快速开始)
5. [高级功能](#高级功能)
6. [常见问题](#常见问题)
7. [技术支持](#技术支持)

---

## 简介
CHOCCY是一个基于 NumPy 构建的启发式优化求解器，用于解决各种优化问题。<br>
它提供了多种优化算法与问题，支持自定义问题的求解，并支持自定义算法的扩展。<br>
本指南旨在帮助用户快速了解和使用优化器。无论您是初学者还是高级用户，都可以在这里找到所需的信息。

## 安装
### 环境要求
- Python 3.7 或更高版本
- numpy、scipy、matplotlib、seaborn、tqdm、networkx、numba 等依赖包

### 安装步骤
1. 使用 Anaconda 创建 Python 环境
   使用 Anaconda 创建环境可以方便地管理依赖包，避免版本冲突。建议从 [Anaconda 官网](https://www.anaconda.com/download/success) 下载并安装 Anaconda。如果需要特定版本，可以访问 [Anaconda所有版本下载地址](https://repo.anaconda.com/archive/)。安装完成 Anaconda 后，运行以下命令快速创建 Python 环境：
   
   ```bash
   conda create --name my_env python=3.9
   conda activate my_env

2. 下载 numpy、scipy、matplotlib、seaborn、tqdm、networkx、numba 等依赖包，运行以下命令一键安装必要包：

   ```bash
   pip install numpy scipy matplotlib seaborn tqdm networkx numba
   ```

## 背景知识
**在使用本项目求解问题之前，需要先熟悉一些背景知识**

### 决策向量/决策变量
决策向量可以理解为需要优化函数的自变量。假设要优化的函数为$y=f(x)$，那么其对应的决策向量为$x$。然而，实际情况下，决策向量通常是多个决策变量的组合。从数学角度来看，要优化的函数更准确的表达应为$y=f(\vec{x})$，其中$\vec{x}=(x_1, x_2, ..., x_n)$。也就是说，该决策向量是一个$n$维向量，换句话说，该决策向量包含$n$个决策变量。

### 目标函数
目标函数实际上就是需要优化的函数。为了统一优化方向，通常将其设定为最小化函数。例如，假设我们要优化（最小化）的函数是$y=x^2$，我们都知道该函数在$x=0$时取得最小值$y=0$，这个过程可以通过计算导函数在$x=0$处取得的极小值，并与可能存在的多个极小值进行比较来得到（假如某函数还存在其他极小值的话），当然，其他求最小值的方法（比如梯度下降方法）也能得到这个结果。然而，对于一些复杂的函数，它们可能无法求导数/梯度，或者求导数/梯度的过程非常困难，那么就需要使用其他的方法（比如“启发式/元启发式”方法）来求最小值。另外，需要注意的是，由于决策向量，也就是输入的自变量，可能是多维的。以给出的例子为例，要最小化的函数就变为了$y=\vec{x}^T\vec{x}$（即向量的平方和），该函数在$\vec{x}=(x_1, x_2, ..., x_n)=(0, 0, ..., 0)$时取得最小值。

### 多目标函数
在了解到目标函数的输入自变量，即决策向量可能是多维的之后，一个自然的延伸问题是：目标函数的输出变量，是否也可能是多维的向量呢？ 如果真是这样，那么目标函数就变为了多目标函数，换句话说，函数的输出可能是多个值，而我们需要同时对这几个值进行优化。

实际上，在大多数情况下，“多目标函数”是由多个目标函数组合而成的。举一个简单的例子：$y=f(x)=\{f_1(x), f_2(x)\} = \{x^2, x^2 + 1\}$，该函数是一个多目标函数，但它非常特殊。在这个例子中，当$x=0$时，两个函数都能同时取得最小值。换句话说，两个函数之间不存在任何“冲突”。这种情况下，同时优化两个函数似乎失去了意义，因为只要优化其中一个就能得到最小值。从狭义上严格来说，这种问题并不算是真正的多目标问题，因为它可以通过加权和的形式转换为单目标问题，优化得到的结果是一致的。

然而，严格来说，真正的多目标函数往往存在某种“冲突”，例如：$y=f(x)=\{f_1(x), f_2(x)\} = \{x^2, (x - 1)^2\}$。在这个例子中，最优解是$x=[0, 1]$整个区间。因为在该区间中，随着一个目标的优化，另一个目标会变差。因此，无法找到一个最优的单个解，最终得到的解是一个区间。这个区间在目标空间中的状态被称为 Pareto 最优前沿（参见图2）。

其实，在生活中存在着许多典型的多目标问题。例如“投资回报问题”，该问题存在的冲突是“风险”与“收益”。一般来说，风险越高，收益越低，反之亦然。当然，多目标问题并不局限于双目标，还有三目标、甚至更多目标的情况。比如，在个人的人生规划中，通常会追求事业目标、家庭目标和个人兴趣目标。这三个目标相互交织，彼此影响，并存在潜在的冲突，例如，过度追求事业目标可能会牺牲与家人相处的时间，而过度投入个人兴趣则可能面临经济压力。因此，我们需要根据自己的价值观和优先级，找到一个相对平衡的解决方案。这种多目标决策过程在我们的生活中无处不在，无论是在个人生活、职业发展还是社会决策中，都需要我们不断地进行权衡和优化。

### 约束函数



## 算法介绍

### 多目标算法

多目标算法旨在同时优化多个目标函数，项目支持的算法清单可参见[实现清单](./IMPLES.md)


### 单目标算法
单目标算法只优化单个目标函数，项目支持的算法清单可参见[实现清单](./IMPLES.md)


## 快速开始

### 问题定义

在使用优化器求解问题之前需要先实现需要求解的问题，所有的问题必须继承 Problems 下的 PROBLEM 父类，并实现计算目标值的函数 _cal_obj 或 _cal_objs
下面以一个问题为例，介绍如何创建需要求解的问题：<br>
假设需要求解的问题是

那么



### 算法选择
定义好问题之后，需要选择一个或多个合适的算法进行求解，具体算法适用求解问题类型可见[算法介绍](#算法介绍)。由于问题是


### 比较器的使用


### 评估器的使用

## 高级功能

### 混合类型问题

### 算法自定义





## 常见问题
- **问题 1**：为什么遗传算法等元启发式算法对简单函数得到的结果不精确，也就是存在精度？
  - **问题原因**：这是遗传算法等元启发式算法本身的特性，即使是最简单的函数，也存在一些精度上的不准确
  - **解决方案**：对与简单问题，若想让精度准确，请使用其他的算法（比如梯度算法）提高精度。
- **问题 2**：为什么大部分算法对问题优化和求解得到的结果非常不稳定？
  - **问题原因**：由于大部分算法是启发式或元启发式算法，本身具有一定的随机性，所以求解不稳定，
  - **解决方案**：若想让求解稳定，可以使用`np.random.seed`函数指定随机种子以使得求解稳定。
- **问题 3**：在使用Evaluator对算法进行评估时，绘制的小提琴图上下界为什么会不准确？
  - **问题原因**：小提琴图是基于核密度估计绘制的，由于核密度估计的特性，小提琴图的范围可能会超出实际数据的范围。
  - **解决方案**：若想让小提琴图绘制准确，在函数`plot_violin()`中加入参数`cut=0`即可

## 技术支持
如果您在使用过程中遇到任何问题，可随时联系
- 邮箱：wangluchen567@qq.com



